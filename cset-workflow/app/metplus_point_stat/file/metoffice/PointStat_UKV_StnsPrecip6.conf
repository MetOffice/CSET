[config]

# List of applications to run - only PointStat for this case
#PROCESS_LIST = PCPCombine(six), PointStat, PointStat(Areas), PointStat(HiRA), PointStat(Srew), PointStat(SrewAreas), PointStat(SrewHiRA)
PROCESS_LIST = PCPCombine(six), PointStat, PointStat(Areas), PointStat(HiRA)

# PCPCombine information
# You can run multiple versions of this in one job. You need to specify ()
# after the process list step eg: PCPCombine(six) and then in the section here
# if you set a starting delimiter to match the bit in the () then that will
# be settings just for that part of the job. So you would have a [six] section
# below to store details just for the (six) job. Therefore you could potentially
# run more than one accum period in one job here!!
# Selection of qc flag entries to include in the output.
# Leave blank to include everything
# Need to directly match what is stored in obs file (include leading zeros if present)
POINT_STAT_OBS_QUALITY_INC = 
POINT_STAT_OBS_QUALITY_EXC =

POINT_STAT_MESSAGE_TYPE = 10101,10102,10201,10202,10204,10210,10310

# fields to compare
# Note: If FCST_VAR<n>_* is set, then a corresponding OBS_VAR<n>_* variable must be set
# To use one variables for both forecast and observation data, set BOTH_VAR<n>_* instead

file_type=NETCDF_NCCF
FCST_VAR1_NAME = precipitation_amount
FCST_VAR1_LEVELS = "(*,*)"
FCST_VAR1_OPTIONS = set_attr_name="PRECIP6"; set_attr_level="A06"
OBS_VAR1_NAME = RAIN
OBS_VAR1_LEVELS = A6
OBS_VAR1_OPTIONS = set_attr_level="A06";convert(x) = max(0,x);

# List of full path to poly masking files.  NOTE: Only short lists of poly
# files work (those that fit on one line), a long list will result in an
# environment variable that is too long, resulting in an error.  For long
# lists of poly masking files (i.e. all the mask files in the NCEP_mask
# directory), define these in the MET point_stat configuration file.
POINT_STAT_MASK_POLY = {MET_AREA_DIR}/poly_umukv.nc

#POINT_STAT_OUTPUT_PREFIX = SurfacePrecip_MPR_{MODEL}_G000
#POINT_STAT_OUTPUT_PREFIX = Surface_6hrPrecip_MPR_{MODEL}_G000
#POINT_STAT_OUTPUT_PREFIX = Surface_MPR_{MODEL}_G000
POINT_STAT_OUTPUT_PREFIX = Surface_6hrPrecip_MPR_{MODEL}_Nearest_G000
POINT_STAT_ONCE_PER_FIELD = False
#POINT_STAT_OUTPUT_PREFIX = {CURRENT_FCST_NAME}_{MODEL}_G000
#POINT_STAT_ONCE_PER_FIELD = True

# Select the type of output file(s) you wish to create
#POINT_STAT_OUTPUT_FLAG_FHO =
#POINT_STAT_OUTPUT_FLAG_CTC =
#POINT_STAT_OUTPUT_FLAG_CTS =
#POINT_STAT_OUTPUT_FLAG_MCTC =
#POINT_STAT_OUTPUT_FLAG_MCTS =
POINT_STAT_OUTPUT_FLAG_CNT = NONE
POINT_STAT_OUTPUT_FLAG_SL1L2 = NONE
#POINT_STAT_OUTPUT_FLAG_SAL1L2 =
POINT_STAT_OUTPUT_FLAG_VL1L2 = NONE
#POINT_STAT_OUTPUT_FLAG_VAL1L2 =
POINT_STAT_OUTPUT_FLAG_VCNT = NONE
#POINT_STAT_OUTPUT_FLAG_PCT =
#POINT_STAT_OUTPUT_FLAG_PSTD =
#POINT_STAT_OUTPUT_FLAG_PJC =
#POINT_STAT_OUTPUT_FLAG_PRC =
#POINT_STAT_OUTPUT_FLAG_ECNT =
#POINT_STAT_OUTPUT_FLAG_RPS =
#POINT_STAT_OUTPUT_FLAG_ECLV =
POINT_STAT_OUTPUT_FLAG_MPR = BOTH

# End of [config] section and start of [dir] section

[dir]
# Template to look for observation input to PointStat relative to OBS_POINT_STAT_INPUT_DIR
#FCST_POINT_STAT_INPUT_DIR = /scratch/cfrd/NGVER/netcdf_globalprecip/
FCST_POINT_STAT_INPUT_DIR = {INPUT_BASE_FORECAST}_precip
OBS_POINT_STAT_INPUT_TEMPLATE = Surface_{valid?fmt=%Y%m%d}T{valid?fmt=%H}00Z.nc
FCST_POINT_STAT_INPUT_TEMPLATE = prods_op_ukv_{init?fmt=%Y%m%d%H}_f{lead?fmt=%HHH}_A6.nc

FCST_PCP_COMBINE_METHOD = SUBTRACT
FCST_PCP_COMBINE_OUTPUT_NAME = precipitation_amount
FCST_PCP_COMBINE_INPUT_DATATYPE = NETCDF
FCST_PCP_COMBINE_INPUT_NAMES = precipitation_amount

[six]
# verbosity of PCPCombine MET output
LOG_PCP_COMBINE_VERBOSITY = 4

# If True, run PCPCombine on forecast data
# observation equivalent OBS_PCP_COMBINE_RUN also exists
FCST_PCP_COMBINE_RUN = True

# mode of PCPCombine to use (SUM, ADD, SUBTRACT, DERIVE, or CUSTOM)
#FCST_PCP_COMBINE_METHOD = SUBTRACT

# maximum forecast lead to allow when searching for model data to use in PCPCombine
# Default is a very large time (4000 years) so setting this to a valid maximum value can
# speed up execution time of numerous runs
FCST_PCP_COMBINE_MAX_FORECAST = 7d

# Input data type of forecast input, only used if data is probabilistic to determine
# how to extract data from file
#FCST_PCP_COMBINE_INPUT_DATATYPE = NETCDF

# This is the 
FCST_PCP_COMBINE_USE_ZERO_ACCUM = True

# List of input names corresponding to each accumulation in *_INPUT_ACCUMS
# Can be left blank if using GRIB input
#FCST_PCP_COMBINE_INPUT_NAMES = precipitation_amount

# List of input levels corresponding to each accumulation in *_INPUT_ACCUMS
# Can be left blank if using GRIB input
#FCST_PCP_COMBINE_INPUT_LEVELS = "({valid?offset},*,*)"
FCST_PCP_COMBINE_INPUT_LEVELS = (*,*)

# desired output accumulation to build with forecast input
# Units are in hours if not specified
# Corresponds to *_OUTPUT_NAME
FCST_PCP_COMBINE_OUTPUT_ACCUM = 6H

# Name of output field name to write
#FCST_PCP_COMBINE_OUTPUT_NAME = precipitation_amount

# If running a MET tool comparison tool after PCPCombine, one can instead set FCST_VAR1_[NAME/LEVELS] to
# a value starting with A that corresponds to the desired accumulation to use in the comparison
# this value will be used to determine the accumulation to build with PCPCombine as well
# If FCST_PCP_COMBINE_OUTPUT_[NAME/ACCUM] are set, these variables take priority over
# FCST_VAR<n>_[NAME/LEVELS]
#FCST_VAR1_NAME = APCP
#FCST_VAR1_LEVELS = 3H

# End of [config] section and start of [dir] section
# input and output data directories
FCST_PCP_COMBINE_INPUT_DIR = {INPUT_BASE_FORECAST}_precip
FCST_PCP_COMBINE_OUTPUT_DIR = {INPUT_BASE_FORECAST}_precip

# End of [dir] section and start of [filename_templates] section
# format of filenames
FCST_PCP_COMBINE_INPUT_TEMPLATE = prods_op_ukv_{init?fmt=%Y%m%d}_{init?fmt=%H}_{lead?fmt=%3H}.nc
FCST_PCP_COMBINE_OUTPUT_TEMPLATE = prods_op_ukv_{init?fmt=%Y%m%d%H}_f{lead?fmt=%HHH}_A6.nc

[Areas]

POINT_STAT_MESSAGE_TYPE = SURFACE

file_type=NETCDF_NCCF
FCST_VAR1_NAME = precipitation_amount
FCST_VAR1_LEVELS = "(*,*)"
FCST_VAR1_OPTIONS = set_attr_name="PRECIP6"; set_attr_level="A06"
FCST_VAR1_THRESH = [<=0.1999, <=0.4999, <=0.9999, <=3.999, <=7.999, <=15.999]
OBS_VAR1_NAME = RAIN
OBS_VAR1_LEVELS = A6
OBS_VAR1_OPTIONS = set_attr_level="A06";convert(x) = max(0,x);
OBS_VAR1_THRESH = [<=0.1999, <=0.4999, <=0.9999, <=3.999, <=7.999, <=15.999]

POINT_STAT_MASK_POLY={MET_AREA_DIR}/poly_umukv.nc
POINT_STAT_MASK_SID={MET_STN_DIR}/2011.stns,
                    {MET_STN_DIR}/2014.stns,
                    {MET_STN_DIR}/2015.stns,
                    {MET_STN_DIR}/2020.stns,
                    {MET_STN_DIR}/2024.stns,
                    {MET_STN_DIR}/2103.stns

# Select the type of output file(s) you wish to create
POINT_STAT_OUTPUT_PREFIX = Surface_6hrPrecip_{MODEL}_Nearest_G000
POINT_STAT_OUTPUT_FLAG_FHO = BOTH
POINT_STAT_OUTPUT_FLAG_CTC = BOTH
POINT_STAT_OUTPUT_FLAG_CTS = BOTH
POINT_STAT_OUTPUT_FLAG_MCTC = BOTH
#POINT_STAT_OUTPUT_FLAG_MCTS =
POINT_STAT_OUTPUT_FLAG_CNT = BOTH
POINT_STAT_OUTPUT_FLAG_SL1L2 = BOTH
#POINT_STAT_OUTPUT_FLAG_SAL1L2 =
POINT_STAT_OUTPUT_FLAG_VL1L2 = NONE
#POINT_STAT_OUTPUT_FLAG_VAL1L2 =
POINT_STAT_OUTPUT_FLAG_VCNT = NONE
#POINT_STAT_OUTPUT_FLAG_PCT =
#POINT_STAT_OUTPUT_FLAG_PSTD =
#POINT_STAT_OUTPUT_FLAG_PJC =
#POINT_STAT_OUTPUT_FLAG_PRC =
#POINT_STAT_OUTPUT_FLAG_ECNT =
#POINT_STAT_OUTPUT_FLAG_RPS =
#POINT_STAT_OUTPUT_FLAG_ECLV =
POINT_STAT_OUTPUT_FLAG_MPR = NONE

# Template to look for observation input to PointStat relative to OBS_POINT_STAT_INPUT_DIR
OBS_POINT_STAT_INPUT_TEMPLATE = Surface_{valid?fmt=%Y%m%d}T{valid?fmt=%H}00Z.nc

[HiRA]

POINT_STAT_MESSAGE_TYPE = SURFACE

# fields to compare
# Note: If FCST_VAR<n>_* is set, then a corresponding OBS_VAR<n>_* variable must be set
# To use one variables for both forecast and observation data, set BOTH_VAR<n>_* instead

#file_type=NETCDF_NCCF
FCST_VAR1_NAME = precipitation_amount
FCST_VAR1_LEVELS = "(*,*)"
FCST_VAR1_OPTIONS = set_attr_name="PRECIP6"; set_attr_level="A06"
OBS_VAR1_NAME = RAIN
OBS_VAR1_LEVELS = A6
OBS_VAR1_OPTIONS = set_attr_level="A06";convert(x) = max(0,x); hira={flag=true; width=[3]; vld_thresh = 1.0; shape = SQUARE; cov_thresh = [ ==0.1 ];prob_cat_thresh = [<0.25, <0.5, <1.0, <2.0, <4.0, <8.0, <16.0, <32.0, <64.0];}

POINT_STAT_MASK_POLY =
POINT_STAT_MASK_SID={MET_STN_DIR}/2015.stns

POINT_STAT_OUTPUT_PREFIX = HiRA_{MODEL}_G000

# Select the type of output file(s) you wish to create
#POINT_STAT_OUTPUT_FLAG_FHO =
#POINT_STAT_OUTPUT_FLAG_CTC =
#POINT_STAT_OUTPUT_FLAG_CTS =
#POINT_STAT_OUTPUT_FLAG_MCTC =
#POINT_STAT_OUTPUT_FLAG_MCTS =
POINT_STAT_OUTPUT_FLAG_CNT = NONE
POINT_STAT_OUTPUT_FLAG_SL1L2 = STAT
#POINT_STAT_OUTPUT_FLAG_SAL1L2 =
POINT_STAT_OUTPUT_FLAG_VL1L2 = STAT
#POINT_STAT_OUTPUT_FLAG_VAL1L2 =
#POINT_STAT_OUTPUT_FLAG_VCNT =
#POINT_STAT_OUTPUT_FLAG_PCT =
#POINT_STAT_OUTPUT_FLAG_PSTD =
#POINT_STAT_OUTPUT_FLAG_PJC =
#POINT_STAT_OUTPUT_FLAG_PRC =
POINT_STAT_OUTPUT_FLAG_ECNT = BOTH
POINT_STAT_OUTPUT_FLAG_RPS = BOTH
POINT_STAT_OUTPUT_FLAG_ORANK = BOTH
#POINT_STAT_OUTPUT_FLAG_ECLV =
POINT_STAT_OUTPUT_FLAG_MPR = BOTH

# Template to look for observation input to PointStat relative to OBS_POINT_STAT_INPUT_DIR
OBS_POINT_STAT_INPUT_TEMPLATE = Surface_{valid?fmt=%Y%m%d}T{valid?fmt=%H}00Z.nc

[SrewAreas]

POINT_STAT_OBS_QUALITY_INC = 
POINT_STAT_OBS_QUALITY_EXC = -99

# Message types, if all message types are to be returned, leave this empty,
# otherwise indicate the message types of interest.
POINT_STAT_MESSAGE_TYPE = SREW
POINT_STAT_MESSAGE_TYPE_GROUP_MAP = { key = "SREW"; val = "10500"; }

file_type=NETCDF_NCCF
FCST_VAR1_NAME = precipitation_amount
FCST_VAR1_LEVELS = "(*,*)"
FCST_VAR1_OPTIONS = set_attr_name="PRECIP6"; set_attr_level="A06"
FCST_VAR1_THRESH = [<=0.1999, <=0.4999, <=0.9999, <=3.999, <=7.999, <=15.999]
OBS_VAR1_NAME = SREW
OBS_VAR1_LEVELS = A6
OBS_VAR1_OPTIONS = set_attr_level="A06";convert(x) = max(0,x);
OBS_VAR1_THRESH = [<=0.1999, <=0.4999, <=0.9999, <=3.999, <=7.999, <=15.999]

POINT_STAT_MASK_POLY={MET_AREA_DIR}/poly_umukv.nc
POINT_STAT_MASK_SID={MET_STN_DIR}/2011.stns,
                    {MET_STN_DIR}/2014.stns,
                    {MET_STN_DIR}/2015.stns,
                    {MET_STN_DIR}/2020.stns,
                    {MET_STN_DIR}/2024.stns,
                    {MET_STN_DIR}/2103.stns

# Select the type of output file(s) you wish to create
POINT_STAT_OUTPUT_PREFIX = {MODEL}_6hrSrewPrecip_G000
POINT_STAT_OUTPUT_FLAG_FHO = BOTH
POINT_STAT_OUTPUT_FLAG_CTC = BOTH
POINT_STAT_OUTPUT_FLAG_CTS = BOTH
POINT_STAT_OUTPUT_FLAG_MCTC = BOTH
#POINT_STAT_OUTPUT_FLAG_MCTS =
POINT_STAT_OUTPUT_FLAG_CNT = BOTH
POINT_STAT_OUTPUT_FLAG_SL1L2 = BOTH
#POINT_STAT_OUTPUT_FLAG_SAL1L2 =
POINT_STAT_OUTPUT_FLAG_VL1L2 = NONE
#POINT_STAT_OUTPUT_FLAG_VAL1L2 =
POINT_STAT_OUTPUT_FLAG_VCNT = NONE
#POINT_STAT_OUTPUT_FLAG_PCT =
#POINT_STAT_OUTPUT_FLAG_PSTD =
#POINT_STAT_OUTPUT_FLAG_PJC =
#POINT_STAT_OUTPUT_FLAG_PRC =
#POINT_STAT_OUTPUT_FLAG_ECNT =
#POINT_STAT_OUTPUT_FLAG_RPS =
#POINT_STAT_OUTPUT_FLAG_ECLV =
POINT_STAT_OUTPUT_FLAG_MPR = NONE

# Template to look for observation input to PointStat relative to OBS_POINT_STAT_INPUT_DIR
OBS_POINT_STAT_INPUT_TEMPLATE = Surface_{valid?fmt=%Y%m%d}T{valid?fmt=%H}00Z.nc

[Srew]

POINT_STAT_OBS_QUALITY_INC = 
POINT_STAT_OBS_QUALITY_EXC = -99

# Message types, if all message types are to be returned, leave this empty,
# otherwise indicate the message types of interest.
POINT_STAT_MESSAGE_TYPE = SREW
POINT_STAT_MESSAGE_TYPE_GROUP_MAP = { key = "SREW"; val = "10500"; }

# fields to compare
# Note: If FCST_VAR<n>_* is set, then a corresponding OBS_VAR<n>_* variable must be set
# To use one variables for both forecast and observation data, set BOTH_VAR<n>_* instead

#file_type=NETCDF_NCCF
FCST_VAR1_NAME = precipitation_amount
FCST_VAR1_LEVELS = "(*,*)"
FCST_VAR1_OPTIONS = set_attr_name="SREW6"; set_attr_level="A06"
OBS_VAR1_NAME = SREW
OBS_VAR1_LEVELS = A6
OBS_VAR1_OPTIONS = set_attr_level="A06";convert(x) = max(0,x); hira={flag=true; width=[3]; vld_thresh = 1.0; shape = SQUARE; cov_thresh = [ ==0.1 ];prob_cat_thresh = [<0.25, <0.5, <1.0, <2.0, <4.0, <8.0, <16.0, <32.0, <64.0];}

POINT_STAT_MASK_POLY={MET_AREA_DIR}/poly_umukv.nc
POINT_STAT_MASK_SID=

POINT_STAT_OUTPUT_PREFIX = {MODEL}_6hrSrewPrecip_G000

# Select the type of output file(s) you wish to create
#POINT_STAT_OUTPUT_FLAG_FHO =
#POINT_STAT_OUTPUT_FLAG_CTC =
#POINT_STAT_OUTPUT_FLAG_CTS =
#POINT_STAT_OUTPUT_FLAG_MCTC =
#POINT_STAT_OUTPUT_FLAG_MCTS =
POINT_STAT_OUTPUT_FLAG_CNT = NONE
POINT_STAT_OUTPUT_FLAG_SL1L2 = STAT
#POINT_STAT_OUTPUT_FLAG_SAL1L2 =
POINT_STAT_OUTPUT_FLAG_VL1L2 = STAT
#POINT_STAT_OUTPUT_FLAG_VAL1L2 =
#POINT_STAT_OUTPUT_FLAG_VCNT =
#POINT_STAT_OUTPUT_FLAG_PCT =
#POINT_STAT_OUTPUT_FLAG_PSTD =
#POINT_STAT_OUTPUT_FLAG_PJC =
#POINT_STAT_OUTPUT_FLAG_PRC =
POINT_STAT_OUTPUT_FLAG_ECNT = BOTH
POINT_STAT_OUTPUT_FLAG_RPS = BOTH
POINT_STAT_OUTPUT_FLAG_ORANK = BOTH
#POINT_STAT_OUTPUT_FLAG_ECLV =
POINT_STAT_OUTPUT_FLAG_MPR = BOTH

# Template to look for observation input to PointStat relative to OBS_POINT_STAT_INPUT_DIR
OBS_POINT_STAT_INPUT_TEMPLATE = SurfaceStn_{valid?fmt=%Y%m%d}T{valid?fmt=%H}00Z.nc

[SrewHiRA]

POINT_STAT_OBS_QUALITY_INC = 
POINT_STAT_OBS_QUALITY_EXC = -99

# Message types, if all message types are to be returned, leave this empty,
# otherwise indicate the message types of interest.
POINT_STAT_MESSAGE_TYPE = SREW
POINT_STAT_MESSAGE_TYPE_GROUP_MAP = { key = "SREW"; val = "10500"; }

# fields to compare
# Note: If FCST_VAR<n>_* is set, then a corresponding OBS_VAR<n>_* variable must be set
# To use one variables for both forecast and observation data, set BOTH_VAR<n>_* instead

#file_type=NETCDF_NCCF
FCST_VAR1_NAME = precipitation_amount
FCST_VAR1_LEVELS = "(*,*)"
FCST_VAR1_OPTIONS = set_attr_name="SREW6"; set_attr_level="A06"
OBS_VAR1_NAME = SREW
OBS_VAR1_LEVELS = A6
OBS_VAR1_OPTIONS = set_attr_level="A06";convert(x) = max(0,x); hira={flag=true; width=[3]; vld_thresh = 1.0; shape = SQUARE; cov_thresh = [ ==0.1 ];prob_cat_thresh = [<0.25, <0.5, <1.0, <2.0, <4.0, <8.0, <16.0, <32.0, <64.0];}

POINT_STAT_MASK_POLY =
POINT_STAT_MASK_SID={MET_STN_DIR}/2015.stns

POINT_STAT_OUTPUT_PREFIX = HiRA_{CURRENT_FCST_NAME}_{MODEL}_Nearest_G000

# Select the type of output file(s) you wish to create
#POINT_STAT_OUTPUT_FLAG_FHO =
#POINT_STAT_OUTPUT_FLAG_CTC =
#POINT_STAT_OUTPUT_FLAG_CTS =
#POINT_STAT_OUTPUT_FLAG_MCTC =
#POINT_STAT_OUTPUT_FLAG_MCTS =
POINT_STAT_OUTPUT_FLAG_CNT = NONE
POINT_STAT_OUTPUT_FLAG_SL1L2 = STAT
#POINT_STAT_OUTPUT_FLAG_SAL1L2 =
POINT_STAT_OUTPUT_FLAG_VL1L2 = STAT
#POINT_STAT_OUTPUT_FLAG_VAL1L2 =
#POINT_STAT_OUTPUT_FLAG_VCNT =
#POINT_STAT_OUTPUT_FLAG_PCT =
#POINT_STAT_OUTPUT_FLAG_PSTD =
#POINT_STAT_OUTPUT_FLAG_PJC =
#POINT_STAT_OUTPUT_FLAG_PRC =
POINT_STAT_OUTPUT_FLAG_ECNT = BOTH
POINT_STAT_OUTPUT_FLAG_RPS = BOTH
POINT_STAT_OUTPUT_FLAG_ORANK = BOTH
#POINT_STAT_OUTPUT_FLAG_ECLV =
POINT_STAT_OUTPUT_FLAG_MPR = BOTH

# Template to look for observation input to PointStat relative to OBS_POINT_STAT_INPUT_DIR
OBS_POINT_STAT_INPUT_TEMPLATE = SurfaceStn_{valid?fmt=%Y%m%d}T{valid?fmt=%H}00Z.nc
