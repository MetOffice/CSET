category: Histogram
title: Histogram $VARNAME
description: |
  Extracts and plots a histogram for `$VARNAME`.

  It uses [`plt.hist`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.hist.html).
  Three methods are possible for constructing the histogram (a) `frequency` histogram plots
  the raw frequency counts in each bin (b) for a `normalised frequency` plot, the
  bins are normalised by the total counts so the plotted frequencies sum to 1 and
  (c) a `density` histogram is the closest analogue
  to the probability density function of the data with the bins being normalised by both
  the total counts and the bin widths. The area under a density histogram integrates to 1.

  Some fields may exhibit numerical beats as a consequence of the low precision used to archive
  the data. These beats will manifest as seemingly spurious, regular peaks in the plotted histogram.
  For example the cloud area fractions from the UM are stored using 6-bit precision
  which allows just 64 values over the range [0, 1] and plotting histograms using 50 bins generates
  numerical beats.

  Histograms of rainfall or snowfall rate are plotted using a logarithmic scale.
  Histograms of rainfall or snowfall amount are based on the
  [Klingaman et al. 2017](https://gmd.copernicus.org/articles/10/57/2017/gmd-10-57-2017.html)
  ASoP method, where histograms show the fractional contributions from each precipitation bin
  to the total precipitation. The area under the histogram shows the total precipitation.

steps:
  - operator: read.read_cubes
    file_paths: $INPUT_PATHS
    model_names: $MODEL_NAME
    constraint:
      operator: constraints.combine_constraints
      variable_constraint:
        operator: constraints.generate_var_constraint
        varname: $VARNAME
      cell_methods_constraint:
        operator: constraints.generate_cell_methods_constraint
        cell_methods: []
        varname: $VARNAME
      pressure_level_constraint:
        operator: constraints.generate_level_constraint
        coordinate: pressure
        levels: []
    subarea_type: $SUBAREA_TYPE
    subarea_extent: $SUBAREA_EXTENT

  - operator: write.write_cube_to_nc
    overwrite: True

  - operator: plot.plot_histogram_series
    sequence_coordinate: $SEQUENCE
