category: Daily Weather
title: "Fog presence\nDifference ($BASE_MODEL - $OTHER_MODEL)"
description: |
  Generates a mask of whether fog is present in a grid box and provides
  the difference between two models. Values will be positive or negative one
  depending on which model has aviation fog present at that location if the other
  does not. Here, fog is defined as when the visibility drops below 250 m (a
  traditional thickness considered by the public for fog)

steps:
  - operator: read.read_cubes
    file_paths: $INPUT_PATHS
    model_names: [$BASE_MODEL, $OTHER_MODEL]
    constraint:
      operator: constraints.combine_constraints
      varname_constraint:
        operator: constraints.generate_var_constraint
        varname: visibility_in_air
      cell_methods_constraint:
        operator: constraints.generate_cell_methods_constraint
        cell_methods: []
    subarea_type: $SUBAREA_TYPE
    subarea_extent: $SUBAREA_EXTENT

  - operator: filters.generate_mask
    condition: 'lt'
    value: 0.25

  - operator: misc.difference

  - operator: plot.spatial_pcolormesh_plot

  - operator: write.write_cube_to_nc
    overwrite: True
